{% extends "layout.j2" %}

{% block content %}
<section class="mb-4">
    <h1 class="h3">Create Batch Runs</h1>
    <p class="text-muted">Phase 0 scaffolding – final workflows will land in later phases.</p>
</section>

{% if not feature_enabled %}
<div class="alert alert-warning" role="alert">
    Batch Runner is currently disabled. Set <code>BATCH_RUNNER_ENABLED=1</code> in the deployment configuration
    to enable the feature once the implementation is complete.
</div>
{% endif %}

<section id="batch-runner-root" class="card">
    <div class="card-body">
        <h2 class="h5">Status</h2>
        <p class="mb-3">This page hosts the forthcoming Batch Runner control. For now it simply confirms wiring and feature-flag behaviour.</p>
        <dl class="row">
            <dt class="col-sm-3">Feature Enabled</dt>
            <dd class="col-sm-9"><span data-role="enabled-flag">{{ feature_enabled }}</span></dd>
            <dt class="col-sm-3">Batch Name</dt>
            <dd class="col-sm-9"><span data-role="batch-name">{{ batch_name or '—' }}</span></dd>
        </dl>
        <details class="mt-3">
            <summary>Bootstrap Manifest</summary>
            <pre class="bg-light p-3" data-role="manifest-json">{{ manifest_payload | tojson(indent=2) }}</pre>
        </details>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    window.batchRunnerBootstrap = {
        enabled: {{ feature_enabled | tojson }},
        batchName: {{ batch_name | tojson }},
        manifest: {{ manifest_payload | tojson }}
    };

    document.addEventListener('DOMContentLoaded', function () {
        if (typeof window.BatchRunner === 'undefined' || typeof window.BatchRunner.getInstance !== 'function') {
            console.warn('BatchRunner control is not yet available.');
            return;
        }
        var control = window.BatchRunner.getInstance();
        control.init(window.batchRunnerBootstrap);
    });
</script>
{% endblock %}
