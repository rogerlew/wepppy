<html>
<script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
<link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />
<script src="https://jsuites.net/v4/jsuites.js"></script>
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<script   src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>    
<body>
<div id="spreadsheet1"></div>
 
<p><button id='save'>Save my changes</button></p>
 
<script>
var mySpreadsheet = jspreadsheet(document.getElementById('spreadsheet1'), {
    csv:'{{ csv_url }}',
    csvHeaders:true,
});
 
document.getElementById('save').onclick = function () {
    var data = mySpreadsheet.getData();
    $.post({
                url: "../tasks/modify_disturbed/",
                data: JSON.stringify(data), 
                contentType: "application/text",
                dataType: "json",
                success: function success(response) {
                },
                error: function error(jqXHR)  {
                    console.log(jqXHR.responseJSON);
                },
                fail: function fail(error) {
                }
            });
};

</script>
</body>
</html>
