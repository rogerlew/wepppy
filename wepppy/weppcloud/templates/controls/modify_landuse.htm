{# Doc: controllers_js/README.md — Landuse Modify Controller Reference (2025 helper migration) #}
{% import "controls/_pure_macros.html" as ui %}
{% from "shared/console_macros.htm" import button_row %}

{% set landuse_select_options = namespace(values=[]) %}
{% for opt in landuseoptions %}
  {% set label = opt["Key"] ~ " — " ~ opt["Description"] %}
  {% set landuse_select_options.values = landuse_select_options.values + [(opt["Key"], label)] %}
{% endfor %}

<div id="modify_landuse_form" class="wc-map-form hide-readonly">
  <h3 class="wc-map-panel__title">Modify Landuse</h3>
  {{ ui.checkbox_field(
       "checkbox_modify_landuse",
       "Enable selection mode",
       help="Click subcatchments to select or deselect them. Hold Shift and drag to draw a selection box.",
       attrs={
         "data-role": "toggle-selection",
         "data-landuse-modify-action": "toggle-selection"
       }
     ) }}

  {{ ui.textarea_field(
       "textarea_modify_landuse",
       "Topaz IDs",
       rows=3,
       placeholder="Topaz IDs",
       attrs={
         "required": "required",
         "data-landuse-modify-field": "topaz-ids"
       }
     ) }}

  {{ ui.select_field(
       "selection_modify_landuse",
       "Select landuse",
       landuse_select_options.values,
       attrs={
         "data-landuse-modify-field": "landuse-code"
       }
     ) }}

  {% call button_row() %}
    <button
      id="btn_modify_landuse"
      type="button"
      class="pure-button pure-button-primary"
      data-landuse-modify-action="submit">
      Modify Landuse
    </button>
  {% endcall %}

  <p class="wc-text-muted">Rebuild soils after completing landuse changes.</p>

  {{ ui.status_panel(
       id="modify_landuse_status_panel",
       title="Status",
       variant="compact",
       log_id="status",
       height="3.25rem"
     ) }}

  {{ ui.stacktrace_panel(
       id="modify_landuse_stacktrace_panel",
       summary="Details",
       collapsed=True,
       body_id="stacktrace",
       empty_state="No stack trace captured."
     ) }}
</div>
